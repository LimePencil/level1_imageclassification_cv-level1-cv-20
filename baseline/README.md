
# 📌 Seperate_Model
## 파일 작성 개요
* 18개 클래스 예측에 기본이 되는 3개의 age, mask, gender를 기존 basecode에서 학습할 경우 각각의 score를 판단하기 위해 작성하기 시작
## 작동 방식

### 💪train_seperate.py
1. train.py에 각각의 클래스를 학습을 위한 모델 선언(Resnet-50)
2. 공통된 데이터셋으로 예측 진행 후 score 계산
3. 역전파 과정을 통해 gradient update
4. 각 모델별 최고 성능 모델을 저장

### 🧠inference_seperate.py
1. 앞서 학습한 각 모델의 최고 성능을 기록한 파라미터를 불러온다.
2. 각 모델별 추론 진행
3. 예측된 결과를 바탕으로 최종 클래스로 변경

## 💖클래스 별 예측 결과
<img src="https://user-images.githubusercontent.com/79644050/198821933-665f7c6a-8990-48ae-898b-d11980ef1bf6.png" width ="80%" height="80%"/>
-> Mask, Gender, Age 중 Age와 관련해서 Validation set에 대한 예측 성능이 낮은 것을 확인 할 수 있었음

### 💦epoch 별 Validation 평가 결과

|   Epoch   | Mask Accuracy | Age Accuracy | Gender Accuracy | Mask Focal Loss | Age Focal Loss | Gender Focal Loss |
| :-------: | :-----------: | :----------: | :-------------: | :-------------: | :------------: | :----------------:|
|     1     |    98.23%     |     83.53%   |       47.93%    |       0.9734    |     0.5917     |      0.4350       |
|     2     |    98.97%     |     81.46%   |       93.64%    |       0.9835    |     0.6962     |      0.9315       |
|     3     |    99.15%     |     75.00%   |       93.62%    |       0.9871    |     0.6193     |      0.9309       |
|     4     |    98.68%     |     85.14%   |       87.79%    |       0.9800    |     0.7395     |      0.8624       |
|     5     |    99.31%     |     85.59%   |       95.05%    |       0.9889    |     0.7367     |      0.9479       |
|     6     |    99.21%     |     84.19%   |     **96.05%**  |       0.9878    |     0.7541     |    **0.9584**     |
|     7     |    97.46%     |   **86.68%** |       95.47%    |       0.9500    |   **0.7663**   |      0.9525       |
|     8     |    99.07%     |     86.31%   |       90.20%    |       0.9852    |     0.7397     |      0.9001       |
|     9     |    99.26%     |     81.51%   |       94.68%    |       0.9888    |     0.6983     |      0.9433       |
|     10    |  **99.39%**   |     84.03%   |       95.90%    |     **0.9906**  |     0.7523     |      0.9569       |
